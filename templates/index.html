<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Xclusive Sports Picks</title>
  <style>
    body {
      background: #0a0a0a;
      color: #f0f0f0;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
    }
    header {
      text-align: center;
      padding: 20px 0 10px;
    }
    header img {
      height: 60px;
    }
    h1 {
      color: #FFD700;
      margin: 5px 0;
    }
    p {
      margin: 0;
      font-size: 14px;
      color: #ccc;
    }
    select {
      margin: 15px auto;
      display: block;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #444;
      background: #1e1e1e;
      color: white;
    }
    .grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px;
    }
    .card {
      background: #1a1a1a;
      border-radius: 10px;
      border-left: 5px solid #555;
      margin: 10px;
      padding: 15px;
      width: 300px;
      box-shadow: 0 0 10px #000;
    }
    .card h3 {
      color: #FFD700;
      margin: 0 0 10px;
    }
    .elite { border-left-color: #ff00e6; }
    .high { border-left-color: #00ff91; }
    .medium { border-left-color: #ffaa00; }
    .low { border-left-color: #ff4d4d; }
    .stake-bar {
      background: #333;
      border-radius: 5px;
      overflow: hidden;
      margin-top: 10px;
      height: 8px;
    }
    .stake-fill {
      background: #FFD700;
      height: 100%;
    }
    small {
      color: #999;
      font-size: 11px;
    }
  </style>
</head>
<body>
  <header>
    <img src="/static/logo.png" alt="Xclusive Logo" />
    <h1>XCLUSIVE SPORTS PICKS</h1>
    <p id="timestamp">Loading...</p>
    <select id="leagueFilter">
      <option value="ALL">All Sports</option>
    </select>
  </header>

  <div class="grid" id="picksContainer"></div>

  <script>
    let picks = [];
    let statuses = {};

    function renderPicks(filter) {
      const container = document.getElementById("picksContainer");
      container.innerHTML = "";
      picks
        .filter(p => filter === "ALL" || p.league === filter)
        .forEach(p => {
          const div = document.createElement("div");
          const tier = p.confidence.toLowerCase();
          const statusText = statuses[p.game] || "Status Unknown";
          div.className = `card ${tier.includes('elite') ? 'elite' : tier.includes('high') ? 'high' : tier.includes('medium') ? 'medium' : 'low'}`;
          div.innerHTML = `
            <h3>${p.emoji} ${p.league}</h3>
            <strong>${p.game}</strong><br>
            <b>Pick:</b> ${p.pick} @ ${p.odds}<br>
            <b>Sharp %:</b> ${p.sharp}<br>
            <b>Confidence:</b> ${p.confidence}<br>
            <div class="stake-bar"><div class="stake-fill" style="width: ${p.stake}%;"></div></div>
            <small>Stake: ${p.stake}% unit</small><br>
            <small><b>Status:</b> ${statusText}</small>
          `;
          container.appendChild(div);
        });
    }

    async function loadData() {
      const [pickRes, statusRes] = await Promise.all([
        fetch("/api/auto-picks"),
        fetch("/api/game-status")
      ]);
      picks = await pickRes.json();
      statuses = await statusRes.json();

      renderPicks("ALL");
      document.getElementById("timestamp").textContent = "Last updated: " + new Date().toLocaleString();
      const leagues = [...new Set(picks.map(p => p.league))];
      const dropdown = document.getElementById("leagueFilter");
      dropdown.innerHTML = `<option value="ALL">All Sports</option>`;
      leagues.forEach(l => {
        const opt = document.createElement("option");
        opt.value = l;
        opt.textContent = l;
        dropdown.appendChild(opt);
      });
    }

    document.getElementById("leagueFilter").addEventListener("change", e => {
      renderPicks(e.target.value);
    });

    loadData();
  </script>
</body>
</html>
